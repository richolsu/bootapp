<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/layout}">
<body>
  <div class="container"  layout:fragment="content">  
      <div class="container">
        <ul class="breadcrumb">
          <li>
            <a href="index.html"><i class="fa fa-dashboard"></i> 首页</a>
          </li>
          <li><a>订单管理</a></li>
          <li><a href="order_delivery_index.html">订单发货</a></li>
          <li class="active">导入送货单</li>
        </ul>
        <div class="text-right" style="margin-top: 10px; margin-bottom: 5px;">
          <a class="btn btn-primary" th:href="@{/vendor/purchaseorder/ship}"> 返回</a>
          <a class="btn btn-primary"> 导入数据</a>
          <a class="btn btn-primary"> 校验</a>
        </div>

        <div class="row">
          <div class="col-lg-12">
              <table id="example" class="ui celled table nowrap" style="width:100%">                  
              </table>
          </div>
        </div>
    </div>
  </div>  
</body>
</html>


<script th:inline="javascript">
	
	$(document).ready(function() {
		var table = $('#example').DataTable({
			ajax : {
				url : /*[[@{/api/purchaseorder/batch_get}]]*/'',
				data : function(data) {
					var filter = {
						rows_per_page: data.length,
						page_index:data.start/data.length+1,
						name:$('#product_name').val()
					}
					return filter;
				},
				dataSrc : function(json) {
					if (json.errcode != 0) {
						alert(json.errmsg);
						json.recordsTotal = 0
						json.recordsFiltered = 0;
						json.purchaseorderlist = [];
					}else{
						json.recordsTotal = json.row_count;
						json.recordsFiltered = json.row_count;
					}
					return json.purchaseorderlist;
				},				
			},
			
			columns : [ {
				data : 'code',
				title : '订单编号',
				defaultContent : ''
			}, {
				data : 'date',
				title : '订单日期',
				render: $.fn.date_renderer,
				defaultContent : ''
			}, {
				data : 'operation_type_code',
				title : '采购业务类型',
				defaultContent : ''
			}, {
				data : 'state',
				title : '订单状态',
				defaultContent : ''
			}, {
				data : 'purchase_type_code',
				title : '采购类型编码',
				defaultContent : ''
			}, {
				data : 'purchase_type_name',
				title : '采购类型',
				defaultContent : ''
			}, {
				data : 'vendorcode',
				title : '供应商编码',
				defaultContent : ''
			}, {
				data : 'vendorname',
				title : '供应商名称',
				defaultContent : ''
			}, {
				data : 'vendorabbname',
				title : '供应商简称',
				defaultContent : ''
			}, {
				data : 'deptcode',
				title : '部门编码',
				defaultContent : ''
			}, {
				data : 'deptcode',
				title : '部门编码',
				defaultContent : ''
			}, {
				data : 'deptname',
				title : '部门名称',
				defaultContent : ''
			}, {
				data : 'personcode',
				title : '业务员编码',
				defaultContent : ''
			}, {
				data : 'personname',
				title : '业务员',
				defaultContent : ''
			}, {
				data : 'remark',
				title : '备注',
				defaultContent : ''
			}, {
				data : 'currency_name',
				title : '外币名称',
				defaultContent : ''
			}, {
				data : 'currency_rate',
				title : '汇率',
				defaultContent : ''
			}, {
				data : 'maker',
				title : '制单人',
				defaultContent : ''
			}, {
				data : 'verifier',
				title : '审核人',
				defaultContent : ''
			}, {
				data : 'closer',
				title : '关闭人',
				defaultContent : ''
			}, {
				data : 'sum',
				title : '原币价税合计',
				defaultContent : ''
			} ],
		});
		
    $("#btn_search").click(function() {
    	table.draw();
    });
    
    $('#product_name').keyup(function(e){
        if(e.keyCode == 13)
        	table.draw();
    });
	});
</script>